<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù† ğŸ‘‘</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { background: #111; color: #fff; font-family: sans-serif; padding: 20px; text-align: center; }
        input, button { width: 90%; padding: 15px; margin: 10px 0; border-radius: 10px; border: none; font-size: 1.1em; }
        input { background: #222; color: #fff; border: 1px solid #444; }
        button { background: #00ffea; color: #000; font-weight: bold; cursor: pointer; }
        label { display: block; text-align: right; width: 90%; margin: auto; color: #aaa; }
        .success { color: #0f0; display: none; }
    </style>
</head>
<body>

    <h1>ğŸ‘‘ Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù…Ø²Ø§Ø¯</h1>

    <label>Ø§Ø³Ù… Ø§Ù„ØºØ±Ø¶ (Title):</label>
    <input type="text" id="title" placeholder="Ù…Ø«Ù„Ø§Ù‹: PUBG Account Level 80">

    <label>Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (Image URL):</label>
    <input type="text" id="image" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„Ù†Øª">

    <label>Ø³Ø¹Ø± Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© / Ø§Ù„Ø­Ø§Ù„ÙŠ ($):</label>
    <input type="number" id="price" placeholder="10">

    <label>Ù…ÙˆØ¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…Ø²Ø§Ø¯:</label>
    <input type="datetime-local" id="ends_at">

    <button onclick="updateAuction()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø²Ø§Ø¯ ÙÙˆØ±Ø§Ù‹ ğŸš€</button>
    <p id="msg" class="success">ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­! âœ…</p>

<script>
    // Ù…ÙØ§ØªÙŠØ­Ùƒ
    const supabaseUrl = 'https://lnamqekqpqyrcwpdbeuf.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxuYW1xZWtxcHF5cmN3cGRiZXVmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA1MDM1NjEsImV4cCI6MjA4NjA3OTU2MX0.SFrtJOP2aBwe2PvOXQRb-IWOzbMghVaMwi0CZC0x1WE';
    const sb = supabase.createClient(supabaseUrl, supabaseKey);

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    async function updateAuction() {
        const title = document.getElementById('title').value;
        const image = document.getElementById('image').value;
        const price = document.getElementById('price').value;
        const ends_at = document.getElementById('ends_at').value;

        if(!title || !price || !ends_at) return alert("Ø¹Ø¨Ù‘ÙŠ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙŠØ§ Ø±ÙŠØ³!");

        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ® Ù„ØµÙŠØºØ© Ø¨ÙŠÙÙ‡Ù…Ù‡Ø§ Ø§Ù„Ø³ÙŠØ±ÙØ±
        const dateISO = new Date(ends_at).toISOString();

        const { error } = await sb
            .from('auctions')
            .update({ 
                title: title,
                image_url: image,
                current_price: Number(price),
                ends_at: dateISO,
                winner_id: null // ØªØµÙÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø­ Ù„ÙØªØ­ Ù…Ø²Ø§Ø¯ Ø¬Ø¯ÙŠØ¯
            })
            .eq('id', 1);

        if(error) alert("Ø®Ø·Ø£: " + error.message);
        else {
            document.getElementById('msg').style.display = 'block';
            // Ù…Ø³Ø­ Ø§Ù„Ù…Ø²Ø§ÙŠØ¯Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¹Ø´Ø§Ù† ØªØ¨Ù„Ø´ Ù…Ù† Ø¬Ø¯ÙŠØ¯
            await sb.from('bids').delete().eq('auction_id', 1);
        }
    }
</script>
</body>
</html>
